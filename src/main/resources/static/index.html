<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Triple-J Car Rentals â€” Premium car rental service. Browse, rent, and reserve vehicles with ease.">
    <title>Triple-J Car Rentals â€” Login</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸš—</text></svg>">
</head>
<body>
    <div class="bg-particles"></div>

    <div class="auth-page">
        <div class="auth-container">
            <div class="auth-card">
                <div class="auth-logo">
                    <div class="logo-icon">ðŸš—</div>
                    <h1>TRIPLE-J</h1>
                    <p>Premium Car Rentals</p>
                </div>

                <div class="auth-tabs">
                    <button class="auth-tab active" onclick="switchAuthTab('login')">Sign In</button>
                    <button class="auth-tab" onclick="switchAuthTab('register')">Register</button>
                </div>

                <!-- Login Form -->
                <form id="loginForm" onsubmit="handleLogin(event)">
                    <div class="form-group">
                        <label>Customer ID</label>
                        <input type="number" class="form-input" id="loginId" placeholder="Enter your Customer ID" required>
                    </div>
                    <button type="submit" class="btn btn-primary btn-full" id="loginBtn">
                        Sign In
                    </button>
                </form>

                <!-- Register Form -->
                <form id="registerForm" style="display:none" onsubmit="handleRegister(event)">
                    <div class="form-group">
                        <label>Full Name</label>
                        <input type="text" class="form-input" id="regName" placeholder="Enter your name" required>
                    </div>
                    <div class="form-group">
                        <label>Contact Number / Email</label>
                        <input type="text" class="form-input" id="regContact" placeholder="Enter contact info" required>
                    </div>
                    <button type="submit" class="btn btn-primary btn-full" id="regBtn">
                        Create Account
                    </button>
                </form>
            </div>
        </div>
    </div>

    <div class="toast-container" id="toastContainer"></div>

    <script src="js/app.js"></script>
    <script>
        function switchAuthTab(tab) {
            document.querySelectorAll('.auth-tab').forEach(t => t.classList.remove('active'));
            if (tab === 'login') {
                document.querySelectorAll('.auth-tab')[0].classList.add('active');
                document.getElementById('loginForm').style.display = 'block';
                document.getElementById('registerForm').style.display = 'none';
            } else {
                document.querySelectorAll('.auth-tab')[1].classList.add('active');
                document.getElementById('loginForm').style.display = 'none';
                document.getElementById('registerForm').style.display = 'block';
            }
        }

        async function handleLogin(e) {
            e.preventDefault();
            const btn = document.getElementById('loginBtn');
            btn.innerHTML = '<div class="spinner"></div> Signing in...';
            btn.disabled = true;

            try {
                const res = await api.login(parseInt(document.getElementById('loginId').value));
                if (res.success) {
                    showToast('success', res.message);
                    localStorage.setItem('customer', JSON.stringify(res.data));
                    setTimeout(() => window.location.href = 'dashboard.html', 800);
                } else {
                    showToast('error', res.message);
                }
            } catch (err) {
                showToast('error', 'Connection error. Please try again.');
            }

            btn.innerHTML = 'Sign In';
            btn.disabled = false;
        }

        async function handleRegister(e) {
            e.preventDefault();
            const btn = document.getElementById('regBtn');
            btn.innerHTML = '<div class="spinner"></div> Creating account...';
            btn.disabled = true;

            try {
                const res = await api.register(
                    document.getElementById('regName').value,
                    document.getElementById('regContact').value
                );
                if (res.success) {
                    showToast('success', res.message);
                    localStorage.setItem('customer', JSON.stringify(res.data));
                    setTimeout(() => window.location.href = 'dashboard.html', 800);
                } else {
                    showToast('error', res.message);
                }
            } catch (err) {
                showToast('error', 'Connection error. Please try again.');
            }

            btn.innerHTML = 'Create Account';
            btn.disabled = false;
        }

        // Redirect if already logged in
        if (localStorage.getItem('customer')) {
            window.location.href = 'dashboard.html';
        }
    </script>
</body>
</html>
